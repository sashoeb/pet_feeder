<!DOCTYPE html>
<html>
<head>
    <title>Pet Feeder</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
</head>
<body>

    <button onclick="dispense_treat()">Feed me!</button>

<script type="text/javascript">
    function dispense_treat(){
        console.log("Dispensing Treat");
        start_communication();
        open_door();
        setTimeout(2000,close_door());
        console.log("Dispensed Treat");
    }
    
    function start_communication(){
        cmd_serial_begin();
        console.log("Init Communication");
    }
    
    function open_door(){
        cmd_serial_write("a");
        console.log("Opened Door");
    }
    
    function close_door(){
        cmd_serial_write("b");
        console.log("Closed Door");
    }
    
    function cmd_serial_write(data_val){
        $.get("https://cloud.boltiot.com/remote/63b45fb2-cac0-455b-afa4-a8c34df8c193/serialWrite?data="+data_val+"&deviceName=BOLT3432337");
    }
    
    function cmd_serial_begin(){
        $.get("https://cloud.boltiot.com/remote/63b45fb2-cac0-455b-afa4-a8c34df8c193/serialBegin?baud=9600&deviceName=BOLT3432337");
    }
</script>


</body>
</html>